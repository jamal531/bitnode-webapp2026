<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bitnode Predictor</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>Bitnode Crypto Predictor</h1>
    <p id="status">Loading...</p>
    <div id="charts"></div>
  </div>

  <script>
    async function fetchData() {
      const res = await fetch('/data');
      const json = await res.json();

      document.getElementById('status').innerText = `Prediction: ${json.prediction}`;

      const onchain = json.onchain;
      const coins = Object.keys(onchain);

      const addresses = coins.map(c => onchain[c].active_addresses);
      const volumes = coins.map(c => onchain[c].volume);

      const addrChart = {
        x: coins,
        y: addresses,
        type: 'bar',
        name: 'Active Addresses'
      };

      const volChart = {
        x: coins,
        y: volumes,
        type: 'bar',
        name: 'Transaction Volume'
      };

      Plotly.newPlot('charts', [addrChart, volChart], {barmode: 'group'});
    }

    fetchData();
    setInterval(fetchData, 30000); // auto-refresh every 30 sec
  </script>
</body>
</html>
